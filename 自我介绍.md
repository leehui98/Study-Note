你好，我叫，是北京邮电大学的一名硕士研究生，平时喜欢打篮球、游泳。现在比较擅长的语言是C++，使用C++实现过一个webserver项目，可以解析get、post请求，处理静态资源，设计思想借鉴了一个TCP网络库的事件驱动的思想，主要技术是Reactor模型、非阻塞IO，使用小根堆管理定时器，使用双缓冲区日志。还对python有一定的了解，之前在图书馆做过两个月的助管，主要的工作是使用python根据一些关键词对数据进行筛选。对网络编程、操作系统、计算机网络的常见协议、常用的数据结构算法也比较熟悉。

项目问题：

- 使用的是什么样的IO多路复用技术？

  主线程使用的是EPOLL的ET模式，子线程使用的是EPOLL的ET模式。

- 线程的工作分配是怎么样的？

  线程分为主线程和子线程。

  主线程负责接受新建立的连接套接字，然后以Round Robin的方式分配给某个子线程，因为涉及到跨线程任务分配，这里需要加锁，这里的锁由某个特定线程的创建，某个线程的锁的争用只会发生在该线程和主线程中。当主线程把新连接分配给某个子线程后，使用eventfd对阻塞在epoll_wait的子线程进行唤醒。

- 锁的作用是什么？

  第一处是任务队列的添加和拿出操作，都需要加锁，并配合条件变量，跨越多个线程。

  第二处是定时器结点的添加和删除，需要加锁，主线程和工作线程都需要操作定时器。

- EPOLL的LT模式和ET模式

  ET模式是边沿触发，LT模式是水平触发。在ET模式下，在有数据到来的时候，如果没有处理完，那么需要等待下一次数据来的时候才会触发。LT模式是，只要缓冲区内有数据就会触发，缺点是可能会经常触发，影响性能。

- 定时器的实现

  使用的是STL里面的优先队列，底层是小根堆，采用惰性删除的方式，时间的到来不会唤醒线程，而是在每次循环的最后进行检查，如果超时再删除。

- 最重要的类

  最能体现整体框架的是Channel类和Eventloop类

  Channel类：Channel是Reactor中的事件，自始至终都属于一个Eventloop，负责一个文件描述符的IO事件，在创建Channel的时候回向里面注册IO事件的类型和对应的回调函数，当IO事件发生时，会调用Channel类中的回调函数。

  Eventloop类：使用的线程模型是One loop per thread，这意味着每一个线程只能由一个时间循环对象，这个对象从epoll中拿出活跃事件，给到Channel里处理。

- 日志的实现

  日志是前端往后端内存中写，后端内存往磁盘里写。因为涉及到IO，一点点写的话速度会变慢。所以设置两个缓冲区，一个写满了，交换指针，写另一个，写满的这个再往磁盘写。

- 死锁

- IO模型